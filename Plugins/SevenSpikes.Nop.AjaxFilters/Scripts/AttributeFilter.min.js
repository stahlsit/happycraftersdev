/*
* Copyright 2012 Seven Spikes Ltd. All rights reserved. (http://www.nop-templates.com)
* http://www.nop-templates.com/t/licensinginfo
*/

$(document).ready(function () { $(".attributeFilterPanel7Spikes .filtersGroupPanel a[data-option-ids]").each(function () { var a = new AttributeFiltersManager; $(this).click(a.filterProductsByProductAttributeOption) }) }); function AttributeFiltersManager() { } AttributeFiltersManager.prototype.filterProductsByProductAttributeOption = FilterProductsByProductAttributeOption; AttributeFiltersManager.prototype.buildAttributeFiltersModel = BuildAttributeFiltersModel; AttributeFiltersManager.prototype.refreshAttributeFilters = RefreshAttributeFilters; FiltersManager.prototype.buildAttributeFiltersModel = (new AttributeFiltersManager).buildAttributeFiltersModel; FiltersManager.prototype.refreshAttributeFilters = (new AttributeFiltersManager).refreshAttributeFilters; function BuildAttributeFiltersModel(a, c) { var b = {}; b.CategoryId = a; b.AttributeFilterGroups = []; $(".attributeFilterPanel7Spikes .filtersGroupPanel").each(function (a, d) { var g = $(d).attr("data-optionsGroupId"), h = {}; h.Id = g; void 0 != c && c.get(0) == d && (h.IsMain = !0, b.Priority = 1); h.FilterItems = []; $(d).find("a[data-option-ids]").each(function (c, a) { var b = $(a).text().trim(), d = $(a).attr("data-option-ids"), e = $(a).attr("class"), f = {}, d = d.split(","); f.Name = b; f.ProductVariantAttributeIds = d; f.FilterItemState = (new FiltersManager).getFilterItemStateBasedOnItemClass(e, f.FilterItemState); h.FilterItems.push(f) }); b.AttributeFilterGroups.push(h) }); return b } function RefreshAttributeFilters(a, c) { $(".attributeFilterPanel7Spikes .filtersGroupPanel").each(function (b, e) { var d = $(e).attr("data-optionsGroupId"), g = $.grep(a.AttributeFilterGroups, function (a) { return a.Id == d }); if (0 != g.length) { var h = g[0]; if (c && "usedropdowns" == c) var j = !0; $(e).find("a[data-option-ids]").each(function (a, b) { var e = $(b).text().trim(), g = $(b).attr("class"), f = $.grep(h.FilterItems, function (a) { return a.Name == e }); 0 != f.length && (f = f[0], c && (1 == f.FilterItemState && "usedropdowns" == c) && (j = !1, SetDropDownSelectedElementForAttributeFilters(d, b)), $(b).attr("class", (new FiltersManager).getFilterItemClassBasedOnState(f.FilterItemState, g))) }); c && ("usedropdowns" == c && !0 == j) && (g = $(e).find(".allFilterDropDownOptions")[0], SetDropDownSelectedElementForAttributeFilters(d, g)) } }) } function SetDropDownSelectedElementForAttributeFilters(a, c) { var b = $("#attributeFiltersDropDown" + a), e = $(c).parent(), d = b.get(0); e.siblings().removeClass("selected"); e.addClass("selected"); d.selectedLiElement = e; b.find("p").text($(c).text()) } function FilterProductsByProductAttributeOption(a) { a = $(a.currentTarget); var c = a.parents("div[data-optionsGroupId]"); (new FiltersManager).requestProductsForSelectedFilters(c, a) };