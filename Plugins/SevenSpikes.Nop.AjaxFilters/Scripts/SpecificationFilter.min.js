/*
* Copyright 2012 Seven Spikes Ltd. All rights reserved. (http://www.nop-templates.com)
* http://www.nop-templates.com/t/licensinginfo
*/

$(document).ready(function () { $(".specificationFilterPanel7Spikes .filtersGroupPanel a[data-option-id]").each(function () { var a = new SpecificationFiltersManager; $(this).click(a.filterProductsBySpecificationAttributeOption) }) }); function SpecificationFiltersManager() { } SpecificationFiltersManager.prototype.filterProductsBySpecificationAttributeOption = FilterProductsBySpecificationAttributeOption; SpecificationFiltersManager.prototype.buildSpecificationFiltersModel = BuildSpecificationFiltersModel; SpecificationFiltersManager.prototype.refreshSpecificationFilters = RefreshSpecificationFilters; FiltersManager.prototype.buildSpecificationFiltersModel = (new SpecificationFiltersManager).buildSpecificationFiltersModel; FiltersManager.prototype.refreshSpecificationFilters = (new SpecificationFiltersManager).refreshSpecificationFilters; function BuildSpecificationFiltersModel(a, c) { var b = {}; b.CategoryId = a; b.SpecificationFilterGroups = []; $(".specificationFilterPanel7Spikes .filtersGroupPanel").each(function (a, d) { var h = $(d).attr("data-optionsGroupId"), g = {}; g.Id = h; void 0 != c && c.get(0) == d && (g.IsMain = !0, b.Priority = 1); g.FilterItems = []; $(d).find("a[data-option-id]").each(function (c, a) { var b = $(a).attr("data-option-id"), d = $(a).attr("class"), e = {}; e.Id = b; e.FilterItemState = (new FiltersManager).getFilterItemStateBasedOnItemClass(d, e.FilterItemState); g.FilterItems.push(e) }); b.SpecificationFilterGroups.push(g) }); return b } function RefreshSpecificationFilters(a, c) { $(".specificationFilterPanel7Spikes .filtersGroupPanel").each(function (b, f) { var d = $(f).attr("data-optionsGroupId"), h = $.grep(a.SpecificationFilterGroups, function (a) { return a.Id == d }); if (0 != h.length) { var g = h[0]; if (c && "usedropdowns" == c) var i = !0; $(f).find("a[data-option-id]").each(function (a, b) { var f = $(b).attr("data-option-id"), e = $.grep(g.FilterItems, function (a) { return a.Id == f }); 0 != e.length && (e = e[0], c && ("usedropdowns" == c && 1 == e.FilterItemState) && (i = !1, SetDropDownSelectedElementForSprcificationFilters(d, b)), $(b).attr("class", (new FiltersManager).getFilterItemClassBasedOnState(e.FilterItemState, $(b).attr("class")))) }); c && ("usedropdowns" == c && !0 == i) && (h = $(f).find(".allFilterDropDownOptions")[0], SetDropDownSelectedElementForSprcificationFilters(d, h)) } }) } function SetDropDownSelectedElementForSprcificationFilters(a, c) { var b = $("#specificationFiltersDropDown" + a), f = $(c).parent(), d = b.get(0); f.siblings().removeClass("selected"); f.addClass("selected"); d.selectedLiElement = f; b.find("p").text($(c).text()) } function FilterProductsBySpecificationAttributeOption(a) { var a = $(a.currentTarget), c = a.parents("div[data-optionsGroupId]"); (new FiltersManager).requestProductsForSelectedFilters(c, a) };